/*
******   CSV for JS  ******
* By Vogel Studio | https://vogel-studio.net
* Apache license 2.0 | https://www.apache.org/licenses/LICENSE-2.0
*/
'use-strict';HTMLTableElement.prototype.toCSV=function(h=true,th=true,f=true){let r='';if(!h){this.querySelector('thead').remove();};if(!f){this.querySelector('tfooter').remove();};let q=th? 'td,th':'td';this.querySelectorAll('tr').forEach(n=>{n.querySelectorAll(q).forEach(c=>{r+='"'+c.textContent.replace(/"/g,'""')+'",';});r+='\n';});return r.replace(/,\n/g,'\n');};HTMLTableElement.prototype.downloadCSV=function(n='values',h=true){let txt=this.toCSV(h);let u=encodeURI(txt);let a=document.createElement('a');a.download=n+'.csv';a.href="data: 'text/csv', "+u;a.click();}